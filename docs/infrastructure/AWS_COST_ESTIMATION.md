# Расчет стоимости AWS инфраструктуры - Sunday School App

## Версия документа: 1.0
**Дата создания:** 27 декабря 2025  
**Последнее обновление:** 27 декабря 2025  
**Проект:** Sunday School App  
**Регион:** us-east-1 (N. Virginia)  
**Целевая аудитория:** Финансовые аналитики, DevOps инженеры, Руководители проектов

---

## 1. Обзор инфраструктуры

### 1.1. Используемые AWS сервисы

Проект Sunday School App использует следующую AWS инфраструктуру:

| Сервис | Назначение | Модель оплаты |
|--------|-----------|---------------|
| **AWS Cognito** | Аутентификация и управление пользователями | Pay-per-MAU (Monthly Active Users) |
| **AWS DynamoDB** | NoSQL база данных | Pay-per-request (On-Demand) |
| **AWS AppSync** | GraphQL API | Pay-per-query |
| **AWS S3** | Хранение файлов (фото учеников, документы) | Pay-per-storage + requests |
| **AWS Amplify Hosting** | Хостинг Next.js приложения | Pay-per-build + bandwidth |
| **AWS CloudFront** | CDN для статического контента | Входит в Amplify Hosting |

### 1.2. Параметры начального этапа

**Исходные данные:**
- **Пользователи Cognito:** 4 (преподаватели/администраторы)
- **Ученики:** 27
- **Группы:** 1
- **Ожидаемая нагрузка:** Низкая (~100-500 запросов в день)
- **Регион:** us-east-1 (N. Virginia)

---

## 2. Детальный расчет по сервисам

### 2.1. AWS Cognito (Аутентификация)

**Назначение:** Управление пользователями, аутентификация, JWT токены

**Модель оплаты:**
- **Free Tier:** Первые 50,000 MAU (Monthly Active Users) бесплатно
- **После Free Tier:** $0.0055 за MAU

**Расчет для начального этапа:**
- **Активных пользователей:** 4 (все пользователи активны)
- **Использование:** 4 MAU
- **В рамках Free Tier:** ✅ Да (4 < 50,000)
- **Стоимость:** **$0.00/месяц**

**Примечание:** При росте до 50,000+ пользователей стоимость составит $0.0055 × (MAU - 50,000)

---

### 2.2. AWS DynamoDB (База данных)

**Назначение:** Хранение всех данных приложения (уроки, ученики, проверки ДЗ, и т.д.)

**Модель оплаты (On-Demand):**
- **Free Tier:** 
  - 25 GB storage бесплатно
  - 25 RCU (Read Capacity Units) бесплатно
  - 25 WCU (Write Capacity Units) бесплатно
- **После Free Tier:**
  - Write requests: $1.25 за миллион запросов
  - Read requests: $0.25 за миллион запросов
  - Storage: $0.25 за GB/месяц

**Расчет объема данных:**

| Таблица | Записей | Размер записи | Общий размер |
|---------|---------|---------------|--------------|
| Users | 4 | ~250 bytes | ~1 KB |
| Grades | 1 | ~200 bytes | ~0.2 KB |
| AcademicYears | 1 | ~180 bytes | ~0.2 KB |
| Lessons | ~30 (1 урок/неделю × 30 недель) | ~400 bytes | ~12 KB |
| Pupils | 27 | ~250 bytes | ~6.8 KB |
| HomeworkChecks | ~810 (30 уроков × 27 учеников) | ~250 bytes | ~202 KB |
| GoldenVerses | ~50 | ~300 bytes | ~15 KB |
| LessonGoldenVerses | ~90 (30 уроков × 3 стиха) | ~120 bytes | ~11 KB |
| Achievements | ~10 | ~200 bytes | ~2 KB |
| PupilAchievements | ~50 | ~130 bytes | ~6.5 KB |
| Families | ~20 | ~400 bytes | ~8 KB |
| FamilyMembers | ~27 | ~100 bytes | ~2.7 KB |
| GradeEvents | ~30 | ~180 bytes | ~5.4 KB |
| GradeSettings | 1 | ~300 bytes | ~0.3 KB |
| Books | 66 | ~200 bytes | ~13 KB |
| UserGrades | 4 | ~150 bytes | ~0.6 KB |
| **ИТОГО** | **~1,200 записей** | | **~286 KB** |

**Расчет запросов (низкая нагрузка):**

- **Запросов в день:** 100-500
- **Запросов в месяц:** ~3,000-15,000
- **Распределение:** 80% read, 20% write
  - **Read requests:** ~2,400-12,000/месяц
  - **Write requests:** ~600-3,000/месяц

**Стоимость:**
- **Storage:** 286 KB << 25 GB (Free Tier) → **$0.00**
- **Read requests:** 12,000 << 25 RCU (Free Tier) → **$0.00**
- **Write requests:** 3,000 << 25 WCU (Free Tier) → **$0.00**
- **Общая стоимость:** **$0.00/месяц**

**Примечание:** При превышении Free Tier:
- Storage: $0.25 × (GB - 25)
- Read: $0.25 × (миллион запросов - 25 RCU)
- Write: $1.25 × (миллион запросов - 25 WCU)

---

### 2.3. AWS AppSync (GraphQL API)

**Назначение:** GraphQL API для взаимодействия с DynamoDB

**Модель оплаты:**
- **Free Tier:** Первые 250,000 queries/месяц бесплатно
- **После Free Tier:** $4.00 за миллион queries
- **Real-time subscriptions:** $2.00 за миллион минут (не используется в MVP)

**Расчет для начального этапа:**
- **Queries в месяц:** ~3,000-15,000 (соответствует запросам к DynamoDB)
- **В рамках Free Tier:** ✅ Да (15,000 << 250,000)
- **Стоимость:** **$0.00/месяц**

**Примечание:** При росте до 250,000+ queries стоимость составит $4.00 × (миллион queries - 250,000)

---

### 2.4. AWS S3 (Хранение файлов)

**Назначение:** Хранение фото учеников, документов уроков (если будут)

**Модель оплаты:**
- **Free Tier:**
  - 5 GB storage бесплатно
  - 20,000 GET requests бесплатно
  - 2,000 PUT requests бесплатно
- **После Free Tier:**
  - Storage: $0.023 за GB/месяц (Standard Storage)
  - GET requests: $0.0004 за 1,000 requests
  - PUT requests: $0.005 за 1,000 requests
  - Data transfer out: $0.09 за GB (первые 100 GB/месяц бесплатно)

**Расчет для начального этапа:**

**Storage:**
- Фото учеников: 27 × 200 KB (сжатые фото) = ~5.4 MB
- Документы уроков: 0 (не используются в MVP)
- **Общий объем:** ~5.4 MB << 5 GB (Free Tier) → **$0.00**

**Requests:**
- GET requests (просмотр фото): ~500/месяц << 20,000 (Free Tier) → **$0.00**
- PUT requests (загрузка фото): ~10/месяц << 2,000 (Free Tier) → **$0.00**

**Data transfer:**
- Исходящий трафик: ~5.4 MB << 100 GB (Free Tier) → **$0.00**

**Стоимость:** **$0.00/месяц**

**Примечание:** При превышении Free Tier:
- Storage: $0.023 × (GB - 5)
- GET: $0.0004 × (тысяч запросов - 20)
- PUT: $0.005 × (тысяч запросов - 2)

---

### 2.5. AWS Amplify Hosting (Хостинг Next.js)

**Назначение:** Хостинг Next.js приложения с SSR поддержкой

**Модель оплаты:**
- **Free Tier:**
  - 1,000 build minutes/месяц бесплатно
  - 15 GB bandwidth/месяц бесплатно
- **После Free Tier:**
  - Build minutes: $0.01 за минуту
  - Bandwidth: $0.15 за GB

**Расчет для начального этапа:**

**Build minutes:**
- Время сборки Next.js: ~5-10 минут/сборка
- Количество сборок: ~10-20/месяц (при активной разработке)
- **Общее время:** ~50-200 минут/месяц << 1,000 (Free Tier) → **$0.00**

**Bandwidth:**
- Размер приложения: ~2-5 MB (после gzip)
- Посещений в день: ~50-200
- Посещений в месяц: ~1,500-6,000
- **Общий трафик:** ~3-30 GB/месяц
  - При низкой нагрузке: ~3-10 GB << 15 GB (Free Tier) → **$0.00**
  - При средней нагрузке: ~10-15 GB ≈ 15 GB (Free Tier) → **$0.00**

**Стоимость:** **$0.00/месяц** (при низкой/средней нагрузке)

**Примечание:** При превышении Free Tier:
- Build: $0.01 × (минут - 1,000)
- Bandwidth: $0.15 × (GB - 15)

---

### 2.6. AWS CloudFront (CDN)

**Назначение:** CDN для статического контента (входит в Amplify Hosting)

**Модель оплаты:**
- CloudFront входит в Amplify Hosting и не требует отдельной оплаты
- Используется автоматически для статического контента

**Стоимость:** **$0.00/месяц** (включено в Amplify Hosting)

---

## 3. Free Tier анализ

### 3.1. Сводная таблица Free Tier

| Сервис | Free Tier лимит | Использование (начальный этап) | В рамках Free Tier |
|--------|-----------------|--------------------------------|-------------------|
| **Cognito** | 50,000 MAU | 4 MAU | ✅ Да |
| **DynamoDB Storage** | 25 GB | ~286 KB | ✅ Да |
| **DynamoDB RCU** | 25 RCU | ~12,000 requests | ✅ Да |
| **DynamoDB WCU** | 25 WCU | ~3,000 requests | ✅ Да |
| **AppSync** | 250,000 queries | ~15,000 queries | ✅ Да |
| **S3 Storage** | 5 GB | ~5.4 MB | ✅ Да |
| **S3 GET** | 20,000 requests | ~500 requests | ✅ Да |
| **S3 PUT** | 2,000 requests | ~10 requests | ✅ Да |
| **Amplify Build** | 1,000 minutes | ~200 minutes | ✅ Да |
| **Amplify Bandwidth** | 15 GB | ~10 GB | ✅ Да |

### 3.2. Выводы

**✅ Все сервисы полностью покрываются Free Tier на начальном этапе**

Использование ресурсов на начальном этапе значительно ниже лимитов Free Tier:
- Использование: **< 1%** от лимитов Free Tier
- Запас для роста: **> 99%** лимитов Free Tier

---

## 4. Расчет для начального этапа

### 4.1. Оценка нагрузки

**Параметры:**
- **Пользователи:** 4 активных пользователя
- **Ученики:** 27
- **Группы:** 1
- **Уроки в месяц:** ~4 (1 урок/неделю)
- **Проверки ДЗ в месяц:** ~108 (4 урока × 27 учеников)

**Запросы к API:**
- **В день:** 100-500 запросов
- **В месяц:** ~3,000-15,000 запросов
- **Распределение:**
  - Read: ~80% (~2,400-12,000)
  - Write: ~20% (~600-3,000)

### 4.2. Расчет объема данных

**DynamoDB:**
- **Текущий объем:** ~286 KB
- **Рост в месяц:** ~50-100 KB (новые уроки, проверки ДЗ)
- **Прогноз через 3 месяца:** ~500 KB
- **Прогноз через 12 месяцев:** ~2-3 GB

**S3:**
- **Текущий объем:** ~5.4 MB (фото учеников)
- **Рост в месяц:** ~1-2 MB (новые фото)
- **Прогноз через 12 месяцев:** ~20-30 MB

### 4.3. Расчет запросов к API

**DynamoDB запросы:**
- **Read:** ~2,400-12,000/месяц
- **Write:** ~600-3,000/месяц
- **Всего:** ~3,000-15,000/месяц

**AppSync queries:**
- Соответствует DynamoDB запросам: ~3,000-15,000/месяц

### 4.4. Расчет хранилища

**DynamoDB:**
- **Текущее:** ~286 KB
- **Free Tier:** 25 GB
- **Использование:** 0.001% от Free Tier

**S3:**
- **Текущее:** ~5.4 MB
- **Free Tier:** 5 GB
- **Использование:** 0.1% от Free Tier

---

## 5. Итоговая стоимость

### 5.1. Месячная стоимость (начальный этап)

| Сервис | Стоимость/месяц |
|--------|-----------------|
| AWS Cognito | $0.00 |
| AWS DynamoDB | $0.00 |
| AWS AppSync | $0.00 |
| AWS S3 | $0.00 |
| AWS Amplify Hosting | $0.00 |
| AWS CloudFront | $0.00 (включено) |
| **ИТОГО** | **$0.00/месяц** |

### 5.2. Прогноз на первые 3 месяца

**Месяц 1-3:**
- Все сервисы в рамках Free Tier
- **Стоимость:** **$0.00/месяц**
- **Общая стоимость за 3 месяца:** **$0.00**

**Примечание:** При условии, что нагрузка остается низкой и не превышает лимиты Free Tier.

### 5.3. Рекомендации по оптимизации

**Для поддержания нулевой стоимости:**

1. **Мониторинг использования:**
   - Настроить CloudWatch alarms для отслеживания приближения к лимитам Free Tier
   - Регулярно проверять использование ресурсов в AWS Console

2. **Оптимизация запросов:**
   - Использовать кеширование на уровне приложения (Next.js cache)
   - Минимизировать количество запросов к DynamoDB через batch operations
   - Использовать GSI эффективно для избежания Scan operations

3. **Оптимизация хранилища:**
   - Сжимать изображения перед загрузкой в S3
   - Использовать S3 Lifecycle policies для архивации старых данных (Post-MVP)
   - Регулярно очищать неиспользуемые данные

4. **Оптимизация сборок:**
   - Использовать кеширование зависимостей в Amplify
   - Минимизировать количество ненужных пересборок
   - Использовать incremental builds Next.js

---

## 6. Прогноз роста стоимости

### 6.1. Сценарий 1: Умеренный рост (6-12 месяцев)

**Параметры:**
- **Пользователи:** 10-20
- **Ученики:** 50-100
- **Группы:** 2-3
- **Запросов в месяц:** ~50,000-100,000

**Расчет стоимости:**

| Сервис | Использование | Стоимость |
|--------|---------------|-----------|
| **Cognito** | 20 MAU << 50,000 | $0.00 |
| **DynamoDB Storage** | ~5 GB << 25 GB | $0.00 |
| **DynamoDB Read** | ~80,000 << 25 RCU | $0.00 |
| **DynamoDB Write** | ~20,000 << 25 WCU | $0.00 |
| **AppSync** | ~100,000 << 250,000 | $0.00 |
| **S3 Storage** | ~50 MB << 5 GB | $0.00 |
| **Amplify Build** | ~500 минут << 1,000 | $0.00 |
| **Amplify Bandwidth** | ~20 GB > 15 GB | $0.75 (5 GB × $0.15) |
| **ИТОГО** | | **~$0.75/месяц** |

### 6.2. Сценарий 2: Значительный рост (12-24 месяца)

**Параметры:**
- **Пользователи:** 50-100
- **Ученики:** 200-500
- **Группы:** 5-10
- **Запросов в месяц:** ~500,000-1,000,000

**Расчет стоимости:**

| Сервис | Использование | Стоимость |
|--------|---------------|-----------|
| **Cognito** | 100 MAU << 50,000 | $0.00 |
| **DynamoDB Storage** | ~20 GB << 25 GB | $0.00 |
| **DynamoDB Read** | ~800,000 (0.8M) | $0.20 (0.8M × $0.25) |
| **DynamoDB Write** | ~200,000 (0.2M) | $0.25 (0.2M × $1.25) |
| **AppSync** | ~1,000,000 (1M) > 250,000 | $3.00 (0.75M × $4.00) |
| **S3 Storage** | ~200 MB << 5 GB | $0.00 |
| **Amplify Build** | ~800 минут << 1,000 | $0.00 |
| **Amplify Bandwidth** | ~50 GB > 15 GB | $5.25 (35 GB × $0.15) |
| **ИТОГО** | | **~$8.70/месяц** |

### 6.3. Сценарий 3: Масштабный рост (24+ месяца)

**Параметры:**
- **Пользователи:** 200-500
- **Ученики:** 1,000-5,000
- **Группы:** 20-50
- **Запросов в месяц:** ~5,000,000-10,000,000

**Расчет стоимости:**

| Сервис | Использование | Стоимость |
|--------|---------------|-----------|
| **Cognito** | 500 MAU << 50,000 | $0.00 |
| **DynamoDB Storage** | ~100 GB > 25 GB | $18.75 (75 GB × $0.25) |
| **DynamoDB Read** | ~8,000,000 (8M) | $2.00 (8M × $0.25) |
| **DynamoDB Write** | ~2,000,000 (2M) | $2.50 (2M × $1.25) |
| **AppSync** | ~10,000,000 (10M) > 250,000 | $39.00 (9.75M × $4.00) |
| **S3 Storage** | ~2 GB << 5 GB | $0.00 |
| **Amplify Build** | ~1,500 минут > 1,000 | $5.00 (500 × $0.01) |
| **Amplify Bandwidth** | ~200 GB > 15 GB | $27.75 (185 GB × $0.15) |
| **ИТОГО** | | **~$95.00/месяц** |

---

## 7. Сравнительная таблица стоимости

| Период | Пользователи | Ученики | Запросов/месяц | Стоимость/месяц |
|--------|--------------|---------|----------------|-----------------|
| **Начальный этап (1-3 мес)** | 4 | 27 | ~15,000 | **$0.00** |
| **Умеренный рост (6-12 мес)** | 20 | 100 | ~100,000 | **~$0.75** |
| **Значительный рост (12-24 мес)** | 100 | 500 | ~1,000,000 | **~$8.70** |
| **Масштабный рост (24+ мес)** | 500 | 5,000 | ~10,000,000 | **~$95.00** |

---

## 8. Дополнительные расходы (опционально)

### 8.1. Резервное копирование DynamoDB

**On-Demand Backup:**
- **Стоимость:** $0.20 за GB/месяц
- **Для начального этапа:** ~286 KB → **$0.00** (минимальная стоимость)
- **Рекомендация:** Использовать Point-in-Time Recovery (PITR) - $0.20 за GB/месяц

### 8.2. CloudWatch Logs

**Стоимость:**
- **Free Tier:** 5 GB ingestion, 5 GB storage бесплатно
- **После Free Tier:** $0.50 за GB ingestion, $0.03 за GB storage
- **Для начального этапа:** В рамках Free Tier → **$0.00**

### 8.3. AWS X-Ray (трейсинг)

**Стоимость:**
- **Free Tier:** 100,000 traces/месяц бесплатно
- **После Free Tier:** $5.00 за миллион traces
- **Для начального этапа:** В рамках Free Tier → **$0.00**

### 8.4. Custom Domain (опционально)

**Стоимость:**
- **Route 53 Hosted Zone:** $0.50/месяц
- **SSL Certificate (ACM):** Бесплатно
- **Дополнительная стоимость:** **$0.50/месяц** (если используется Route 53)

---

## 9. Итоговые выводы

### 9.1. Начальный этап (1-3 месяца)

**✅ Полностью бесплатно в рамках AWS Free Tier**

- Все сервисы покрываются Free Tier
- Использование ресурсов: **< 1%** от лимитов
- **Стоимость:** **$0.00/месяц**

### 9.2. Рекомендации

1. **Мониторинг:**
   - Настроить CloudWatch alarms для отслеживания использования
   - Регулярно проверять AWS Cost Explorer

2. **Оптимизация:**
   - Использовать кеширование на всех уровнях
   - Оптимизировать запросы к DynamoDB
   - Минимизировать размер статических ресурсов

3. **Планирование:**
   - При приближении к лимитам Free Tier рассмотреть оптимизацию или переход на Provisioned Capacity (для DynamoDB)
   - Планировать рост нагрузки заранее

### 9.3. Прогноз на год

**При умеренном росте:**
- **Первые 6 месяцев:** $0.00/месяц
- **6-12 месяцев:** ~$0.75-2.00/месяц
- **Средняя стоимость за год:** **~$6-12**

**При значительном росте:**
- **Первые 3 месяца:** $0.00/месяц
- **3-6 месяцев:** ~$0.75-2.00/месяц
- **6-12 месяцев:** ~$8-15/месяц
- **Средняя стоимость за год:** **~$30-50**

---

## 10. Ссылки и ресурсы

### 10.1. Официальная документация AWS

- [AWS Pricing Calculator](https://calculator.aws/)
- [AWS Free Tier](https://aws.amazon.com/free/)
- [Cognito Pricing](https://aws.amazon.com/cognito/pricing/)
- [DynamoDB Pricing](https://aws.amazon.com/dynamodb/pricing/)
- [AppSync Pricing](https://aws.amazon.com/appsync/pricing/)
- [S3 Pricing](https://aws.amazon.com/s3/pricing/)
- [Amplify Hosting Pricing](https://aws.amazon.com/amplify/pricing/)

### 10.2. Документация проекта

- [ARCHITECTURE.md](../architecture/ARCHITECTURE.md) - Архитектура системы
- [AWS_AMPLIFY.md](./AWS_AMPLIFY.md) - Конфигурация Amplify
- [DYNAMODB_SCHEMA.md](../database/DYNAMODB_SCHEMA.md) - Схема базы данных

---

## 11. Примечания

### 11.1. Актуальность цен

- Цены указаны для региона **us-east-1 (N. Virginia)** на декабрь 2025
- Цены могут изменяться, рекомендуется проверять актуальные цены на официальном сайте AWS
- Для других регионов цены могут отличаться

### 11.2. Условия Free Tier

- Free Tier действует в течение **12 месяцев** с момента создания AWS аккаунта (для новых аккаунтов)
- Некоторые сервисы (Cognito, DynamoDB, AppSync) имеют **постоянный Free Tier** (не ограничен 12 месяцами)
- Рекомендуется мониторить использование ресурсов, чтобы избежать неожиданных расходов

### 11.3. Налоги и сборы

- Указанные цены не включают налоги
- Налоги могут применяться в зависимости от юрисдикции
- Рекомендуется уточнить налоговые обязательства у финансового отдела

---

**Версия:** 1.0  
**Последнее обновление:** 27 декабря 2025  
**Автор:** AI Financial Analyst & AWS Cost Optimization Specialist

