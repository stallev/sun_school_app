# Phase 18: Управление семьями (Families)

## Описание фазы
Реализация CRUD операций для семей: создание, редактирование, удаление. Связывание учеников с семьями, управление контактами семьи.

## Зависимости
Phase 16: Управление учениками (Pupils)

## Оценка времени
4-5 часов

## Требования к AI Agent

> [!IMPORTANT]
> - AI Agent при создании программного кода должен использовать актуальную документацию через Context7
> - Следовать принципам из `docs/guidelines/prompts/general_prompt_guidelines.md`

## Задачи

### Task 18.01: Создание Server Actions для семей
- [ ] Создать `app/actions/families.ts`
- [ ] Реализовать CRUD операции: create, update, delete, get, list
- [ ] Реализовать `addPupilToFamily(familyId, pupilId)` - добавление ученика в семью
- [ ] Реализовать `removePupilFromFamily(familyId, pupilId)` - удаление ученика из семьи
- [ ] Добавить проверку прав доступа (Admin only)

**Документация:**
- [SERVER_ACTIONS.md](../../../api/SERVER_ACTIONS.md) - раздел Families
- [VALIDATION.md](../../../api/VALIDATION.md) - раздел Family Schemas
- [MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.10.3 Управление семьями

**Критерии приемки:**
- Все Server Actions созданы
- Проверка прав доступа работает

---

### Task 18.02: Создание UI для списка семей
- [ ] Создать `app/(private)/families/page.tsx`
- [ ] Реализовать таблицу со списком семей
- [ ] Отобразить количество членов семьи
- [ ] Добавить фильтрацию и поиск
- [ ] Добавить кнопку создания новой семьи (Admin only)

**Документация:**
- [WIREFRAMES.md](../../../ui_ux/WIREFRAMES.md) - раздел Families List
- [USER_FLOW.md](../../../user_flows/USER_FLOW.md) - раздел Admin flows
- [ADMIN_FLOWS.md](../../../user_flows/ADMIN_FLOWS.md) - раздел 5.1 Создание новой семьи

**Критерии приемки:**
- Страница списка создана
- Фильтрация работает

---

### Task 18.03: Создание формы создания/редактирования семьи
- [ ] Создать Client Component формы
- [ ] Реализовать поля: название семьи, телефон, email, адрес (опционально)
- [ ] Интегрировать с React Hook Form и Zod валидацией
- [ ] Добавить валидацию email и телефона

**Документация:**
- [WIREFRAMES.md](../../../ui_ux/WIREFRAMES.md) - раздел Family Form
- [VALIDATION.md](../../../api/VALIDATION.md) - раздел Family Schemas
- [ADMIN_FLOWS.md](../../../user_flows/ADMIN_FLOWS.md) - раздел 5.1 Создание новой семьи

**Критерии приемки:**
- Форма создана
- Валидация работает

---

### Task 18.04: Реализация управления членами семьи
- [ ] Создать компонент для управления членами семьи
- [ ] Реализовать добавление учеников в семью
- [ ] Реализовать удаление учеников из семьи
- [ ] Отобразить список всех членов семьи

**Документация:**
- [MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.10.3 Управление членами семьи

**Критерии приемки:**
- Управление членами работает
- Список членов отображается

---

### Task 18.05: Реализация управления контактами
- [ ] Отобразить контакты семьи в профиле семьи
- [ ] Реализовать редактирование контактов
- [ ] Добавить валидацию контактов

**Документация:**
- [MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.10.3 Контакты семьи

**Критерии приемки:**
- Контакты отображаются
- Редактирование работает

---

### Task 18.06: Тестирование функционала семей
- [ ] Протестировать CRUD операции
- [ ] Протестировать управление членами семьи
- [ ] Протестировать управление контактами

**Критерии приемки:**
- Все тесты пройдены успешно
- Функционал работает корректно

---

## Ссылки на документацию проекта

- [SERVER_ACTIONS.md](../../../api/SERVER_ACTIONS.md) - Families Actions
- [VALIDATION.md](../../../api/VALIDATION.md) - Family Schemas
- [MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.10.3

---

**Версия:** 1.0  
**Последнее обновление:** 23 декабря 2025

