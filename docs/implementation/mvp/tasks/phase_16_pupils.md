# Phase 16: Управление учениками (Pupils)

## Описание фазы
Реализация CRUD операций для учеников: создание, редактирование, просмотр, деактивация. Привязка к группам и семьям, просмотр истории групп.

## Зависимости
Phase 11: Управление группами (Grades)

## Оценка времени
6-7 часов

## Требования к AI Agent

> [!IMPORTANT]
> - AI Agent при создании программного кода должен использовать актуальную документацию через Context7
> - Перед созданием кода необходимо проверять какой функционал NextJS поддерживается AWS Amplify
> - Следовать принципам из `docs/guidelines/prompts/general_prompt_guidelines.md`

## Задачи

### Task 16.01: Создание Server Actions для учеников
- [ ] Создать `app/actions/pupils.ts`
- [ ] Реализовать CRUD операции: create, update, delete, get, list
- [ ] Реализовать `assignPupilToGrade(pupilId, gradeId)` - назначение на группу
- [ ] Реализовать `getPupilHistory(pupilId)` - история групп ученика
- [ ] Добавить проверку прав доступа (Admin only)

**Документация:**
- [SERVER_ACTIONS.md](../../../api/SERVER_ACTIONS.md) - раздел Pupils
- [VALIDATION.md](../../../api/VALIDATION.md) - раздел Pupil Schemas
- [MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.10.2 Управление учениками

**Критерии приемки:**
- Все Server Actions созданы
- Проверка прав доступа работает

---

### Task 16.02: Создание UI для списка учеников
- [ ] Создать `app/(private)/pupils/page.tsx`
- [ ] Реализовать таблицу со списком учеников
- [ ] Добавить фильтрацию и поиск
- [ ] Добавить пагинацию
- [ ] Добавить кнопку создания нового ученика (Admin only)

**Документация:**
- [WIREFRAMES.md](../../../ui_ux/WIREFRAMES.md) - раздел Pupils List
- [USER_FLOW.md](../../../user_flows/USER_FLOW.md) - раздел Admin flows
- [ADMIN_FLOWS.md](../../../user_flows/ADMIN_FLOWS.md) - раздел 4.1 Создание нового ученика

**Критерии приемки:**
- Страница списка создана
- Фильтрация работает
- Пагинация работает

---

### Task 16.03: Создание формы создания/редактирования ученика
- [ ] Создать Client Component формы
- [ ] Реализовать поля: имя, фамилия, возраст, группа, семья
- [ ] Интегрировать с React Hook Form и Zod валидацией
- [ ] Добавить выбор группы из списка
- [ ] Добавить выбор семьи из списка (опционально)

**Документация:**
- [WIREFRAMES.md](../../../ui_ux/WIREFRAMES.md) - раздел Pupil Form
- [VALIDATION.md](../../../api/VALIDATION.md) - раздел Pupil Schemas
- [ADMIN_FLOWS.md](../../../user_flows/ADMIN_FLOWS.md) - раздел 4.1 Создание нового ученика

**Критерии приемки:**
- Форма создана
- Валидация работает
- Выбор группы и семьи работает

---

### Task 16.04: Реализация назначения ученика на группу
- [ ] Создать компонент для назначения на группу
- [ ] Реализовать выбор группы из списка
- [ ] Сохранить назначение через Server Action
- [ ] Обновить историю групп ученика

**Документация:**
- [MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.10.2 Управление группами

**Критерии приемки:**
- Назначение на группу работает
- История обновляется

---

### Task 16.05: Реализация привязки к семье
- [ ] Создать компонент для привязки к семье
- [ ] Реализовать выбор семьи из списка
- [ ] Сохранить привязку через Server Action
- [ ] Отобразить семью в профиле ученика

**Документация:**
- [MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.10.2 Связывание с семьями

**Критерии приемки:**
- Привязка к семье работает
- Семья отображается в профиле

---

### Task 16.06: Реализация просмотра истории групп
- [ ] Создать компонент для отображения истории групп
- [ ] Отобразить все группы, в которых был ученик
- [ ] Показать даты начала и окончания пребывания в группе
- [ ] Добавить возможность просмотра в профиле ученика

**Документация:**
- [MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.10.2 Просмотр истории групп

**Критерии приемки:**
- История групп отображается
- Данные корректны

---

### Task 16.07: Тестирование функционала учеников
- [ ] Протестировать CRUD операции
- [ ] Протестировать назначение на группу
- [ ] Протестировать привязку к семье
- [ ] Протестировать просмотр истории

**Критерии приемки:**
- Все тесты пройдены успешно
- Функционал работает корректно

---

## Ссылки на документацию проекта

- [SERVER_ACTIONS.md](../../../api/SERVER_ACTIONS.md) - Pupils Actions
- [VALIDATION.md](../../../api/VALIDATION.md) - Pupil Schemas
- [MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.10.2

---

**Версия:** 1.0  
**Последнее обновление:** 23 декабря 2025

