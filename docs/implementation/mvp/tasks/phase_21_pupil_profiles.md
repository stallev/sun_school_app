# Phase 21: Личные карточки учеников

## Описание фазы
Реализация личных карточек учеников: профиль ученика, история всех уроков с результатами, статистика (баллы, средний балл, количество домиков, badges), график прогресса.

## Зависимости
Phase 15: Система баллов и домиков, Phase 16: Управление учениками (Pupils)

## Оценка времени
6-8 часов

## Требования к AI Agent

<requirements>
<role>
Ты — Senior Full-Stack Developer с 5+ летним опытом разработки React приложений, специализирующийся на:
- Next.js 15.5.9 App Router и Server Components
- React 19 и современные паттерны React
- Визуализация данных и графики (recharts, Chart.js)
- Shadcn UI и Tailwind CSS
- AWS Amplify Gen 1 и AppSync GraphQL
- TypeScript с строгой типизацией
</role>

<context>
Проект: Sunday School Management System (MVP)
Технологии: Next.js 15.5.9, React 19, AWS Amplify Gen 1, AppSync GraphQL, Shadcn UI, recharts, TypeScript
Ограничения: MVP подход (функциональность важнее идеального кода), доступность критически важна, компоненты должны следовать дизайн-системе
Зависимости: Phase 15 (Система баллов и домиков), Phase 16 (Управление учениками)
</context>

<critical_instructions>
Вдохни глубоко, расправь плечи и приступай к решению задачи шаг за шагом. Это критически важная фаза для реализации личных карточек учеников. Правильная реализация профилей определит качество пользовательского опыта для учителей при работе с данными учеников.

<CRITICAL>Перед началом работы:</CRITICAL>
1. Изучи MVP_SCOPE.md раздел 2.5 Личные карточки учеников - полные требования к функционалу
2. Изучи WIREFRAMES.md раздел Pupil Profile - визуальные требования
3. Изучи TEACHER_FLOWS.md раздел 5.1 - пользовательские сценарии
4. Используй Context7 для получения актуальной документации recharts для графиков
5. Используй Context7 для получения актуальной документации Shadcn UI компонентов
6. Следуй принципам из `docs/guidelines/prompts/general_prompt_guidelines.md`

<CONSTRAINT>Все компоненты должны следовать дизайн-системе проекта и быть доступными (WCAG 2.1 AA). Графики должны быть интерактивными и адаптивными для разных экранов.</CONSTRAINT>
</critical_instructions>
</requirements>

## Задачи

### Task 21.01: Создание страницы профиля ученика

<context>
<CRITICAL>Это первая и критически важная задача фазы!</CRITICAL> Создание страницы профиля ученика является основой для всех остальных компонентов фазы. Правильная реализация страницы определит структуру данных и навигацию для всех последующих задач.
</context>

<task>
Создай страницу профиля ученика `app/(private)/pupils/[pupilId]/page.tsx` как Server Component. Реализуй загрузку данных ученика через amplifyData и отобрази основную информацию: имя, фамилия, возраст, группа, семья. Используй компоненты Shadcn UI (Card, Avatar, Badge) для визуального оформления.
</task>

<constraints>
- Страница должна быть Server Component (по умолчанию)
- Используй amplifyData для загрузки данных через AppSync GraphQL
- Компоненты Shadcn UI должны быть из `components/ui/`
- Структура должна соответствовать WIREFRAMES.md
- Данные должны быть валидированы через Zod схемы
- Обработка ошибок обязательна
</constraints>

<thinking>
Прежде чем приступить к реализации:
1. Изучи WIREFRAMES.md раздел Pupil Profile для понимания визуальной структуры
2. Изучи MVP_SCOPE.md раздел 2.5 Личные карточки учеников для понимания требований
3. Изучи TEACHER_FLOWS.md раздел 5.1 для понимания пользовательских сценариев
4. Изучи GraphQL схему для понимания структуры данных Pupil
5. Используй Context7 для получения актуальной документации Next.js App Router
6. Используй Context7 для получения актуальной документации Shadcn UI компонентов
7. Только после этого создавай страницу
</thinking>

**Действия:**
- [ ] Создать `app/(private)/pupils/[pupilId]/page.tsx`
- [ ] Реализовать Server Component для загрузки данных ученика через amplifyData
- [ ] Отобразить основную информацию: имя, фамилия, возраст, группа, семья
- [ ] Использовать компоненты Shadcn UI (Card, Avatar, Badge)
- [ ] Добавить обработку ошибок и loading states

**Документация:**
- <CRITICAL>[WIREFRAMES.md](../../../ui_ux/WIREFRAMES.md) - раздел Pupil Profile</CRITICAL>
- <CRITICAL>[MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.5 Личные карточки учеников</CRITICAL>
- <CRITICAL>[TEACHER_FLOWS.md](../../../user_flows/TEACHER_FLOWS.md) - раздел 5.1 Просмотр личной карточки ученика</CRITICAL>
- Context7: Next.js 15.5.9 App Router документация
- Context7: Shadcn UI компоненты документация

**Критерии приемки:**
- Страница профиля создана
- Основная информация отображается корректно
- Данные загружаются через amplifyData
- Обработка ошибок работает

<output_format>
После выполнения задачи должна быть создана страница профиля ученика, которая загружает данные через amplifyData и отображает основную информацию ученика с использованием компонентов Shadcn UI.
</output_format>

---

### Task 21.02: Реализация статистики ученика

<context>
Реализация статистики ученика критически важна для быстрого понимания успеваемости ученика. Статистика должна отображать ключевые метрики: общее количество баллов, средний балл, количество посещенных уроков, количество домиков и badges.
</context>

<task>
Создай компонент `components/organisms/pupils/pupil-stats.tsx` для отображения статистики ученика. Реализуй расчет и отображение всех метрик: всего баллов, средний балл, количество уроков посещено, количество домиков, количество badges. Используй компоненты Shadcn UI (Card, Badge) для визуального оформления.
</task>

<constraints>
- Компонент должен быть Server Component (если не требуется интерактивность)
- Расчет статистики должен выполняться на сервере
- Данные должны быть получены через amplifyData
- Компоненты Shadcn UI должны быть из `components/ui/`
- Статистика должна быть актуальной и корректной
- Обработка ошибок обязательна
</constraints>

<thinking>
Прежде чем приступить к реализации:
1. Изучи MVP_SCOPE.md раздел 2.5.2 Статистика для понимания требований
2. Изучи TEACHER_FLOWS.md раздел 5.1 для понимания контекста использования
3. Изучи GraphQL схему для понимания структуры данных для расчета статистики
4. Определи, какие данные нужны для расчета каждой метрики
5. Продумай структуру компонента согласно Atomic Design
6. Только после этого создавай компонент
</thinking>

**Действия:**
- [ ] Создать компонент `components/organisms/pupils/pupil-stats.tsx`
- [ ] Реализовать расчет статистики на сервере
- [ ] Отобразить статистику:
  - Всего баллов
  - Средний балл
  - Количество уроков посещено
  - Количество домиков
  - Количество badges
- [ ] Использовать компоненты Shadcn UI (Card, Badge)
- [ ] Добавить обработку ошибок

**Документация:**
- <CRITICAL>[MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.5.2 Статистика</CRITICAL>
- <CRITICAL>[TEACHER_FLOWS.md](../../../user_flows/TEACHER_FLOWS.md) - раздел 5.1 Просмотр личной карточки ученика</CRITICAL>
- Context7: Shadcn UI компоненты документация

**Критерии приемки:**
- Статистика отображается корректно
- Данные корректны и актуальны
- Компонент следует Atomic Design принципам
- Обработка ошибок работает

<output_format>
После выполнения задачи должен быть создан компонент статистики ученика, который отображает все ключевые метрики с использованием компонентов Shadcn UI.
</output_format>

---

### Task 21.03: Реализация таблицы истории уроков

<context>
Таблица истории уроков критически важна для отслеживания прогресса ученика по всем урокам. Таблица должна отображать полную историю с результатами, баллами и статусами домиков для каждого урока.
</context>

<task>
Создай компонент `components/organisms/pupils/lesson-history.tsx` для отображения таблицы истории уроков. Реализуй таблицу со списком всех уроков с результатами, отображением даты урока, баллов за урок, статуса домика и параметров проверки. Добавь сортировку по дате. Используй компоненты Shadcn UI (Table).
</task>

<constraints>
- Компонент должен быть Server Component (если не требуется интерактивность)
- Данные должны быть получены через amplifyData
- Таблица должна поддерживать сортировку по дате
- Компоненты Shadcn UI должны быть из `components/ui/`
- Таблица должна быть адаптивной для разных экранов
- Обработка ошибок обязательна
</constraints>

<thinking>
Прежде чем приступить к реализации:
1. Изучи MVP_SCOPE.md раздел 2.5.3 История уроков для понимания требований
2. Изучи WIREFRAMES.md раздел Pupil History для понимания визуальной структуры
3. Изучи GraphQL схему для понимания структуры данных Lesson и HomeworkCheck
4. Определи, какие данные нужны для отображения в таблице
5. Продумай логику сортировки
6. Только после этого создавай компонент
</thinking>

**Действия:**
- [ ] Создать компонент `components/organisms/pupils/lesson-history.tsx`
- [ ] Реализовать таблицу со списком всех уроков с результатами
- [ ] Отобразить: дата урока, баллы за урок, статус домика, параметры проверки
- [ ] Добавить сортировку по дате
- [ ] Использовать компоненты Shadcn UI (Table)
- [ ] Добавить адаптивность для мобильных устройств
- [ ] Добавить обработку ошибок

**Документация:**
- <CRITICAL>[MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.5.3 История уроков</CRITICAL>
- <CRITICAL>[WIREFRAMES.md](../../../ui_ux/WIREFRAMES.md) - раздел Pupil History</CRITICAL>
- Context7: Shadcn UI Table документация

**Критерии приемки:**
- Таблица истории создана
- Данные отображаются корректно
- Сортировка работает
- Таблица адаптивна для разных экранов
- Обработка ошибок работает

<output_format>
После выполнения задачи должна быть создана таблица истории уроков, которая отображает полную историю с результатами и поддерживает сортировку по дате.
</output_format>

---

### Task 21.04: Реализация визуализации домиков

<context>
Визуализация домиков критически важна для мотивации учеников. Компонент должен отображать количество полученных домиков и историю их получения, что помогает ученикам видеть свой прогресс.
</context>

<task>
Создай компонент `components/organisms/pupils/houses-display.tsx` для визуализации домиков. Реализуй отображение визуализации домиков, покажи количество домиков и историю получения домиков. Используй компоненты Shadcn UI для визуального оформления.
</task>

<constraints>
- Компонент должен быть Server Component (если не требуется интерактивность)
- Данные должны быть получены через amplifyData
- Визуализация должна быть понятной и привлекательной
- Компоненты Shadcn UI должны быть из `components/ui/`
- История должна отображаться в хронологическом порядке
- Обработка ошибок обязательна
</constraints>

<thinking>
Прежде чем приступить к реализации:
1. Изучи MVP_SCOPE.md раздел 2.5.4 Домики для понимания требований
2. Изучи Phase 15 (Система баллов и домиков) для понимания структуры данных домиков
3. Изучи GraphQL схему для понимания структуры данных House
4. Определи, как лучше визуализировать домики
5. Продумай отображение истории получения домиков
6. Только после этого создавай компонент
</thinking>

**Действия:**
- [ ] Создать компонент `components/organisms/pupils/houses-display.tsx`
- [ ] Реализовать визуализацию домиков
- [ ] Показать количество домиков
- [ ] Показать историю получения домиков
- [ ] Использовать компоненты Shadcn UI для оформления
- [ ] Добавить обработку ошибок

**Документация:**
- <CRITICAL>[MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.5.4 Домики</CRITICAL>
- Phase 15: Система баллов и домиков
- Context7: Shadcn UI компоненты документация

**Критерии приемки:**
- Визуализация домиков создана
- История отображается корректно
- Компонент следует дизайн-системе
- Обработка ошибок работает

<output_format>
После выполнения задачи должна быть создана визуализация домиков, которая отображает количество домиков и историю их получения.
</output_format>

---

### Task 21.05: Реализация визуализации badges

<context>
Визуализация badges критически важна для мотивации учеников. Компонент должен отображать список полученных badges с визуальным представлением и критериями получения, что помогает ученикам понимать свои достижения.
</context>

<task>
Создай компонент `components/organisms/pupils/badges-display.tsx` для визуализации badges. Реализуй отображение списка полученных badges, покажи визуальное отображение badges и критерии получения (если требуется). Используй компоненты Shadcn UI для визуального оформления.
</task>

<constraints>
- Компонент должен быть Server Component (если не требуется интерактивность)
- Данные должны быть получены через amplifyData
- Badges должны отображаться визуально привлекательно
- Компоненты Shadcn UI должны быть из `components/ui/`
- Критерии получения должны быть понятными
- Обработка ошибок обязательна
</constraints>

<thinking>
Прежде чем приступить к реализации:
1. Изучи MVP_SCOPE.md раздел 2.5.4 Badges для понимания требований
2. Изучи Phase 15 (Система баллов и домиков) для понимания структуры данных badges
3. Изучи GraphQL схему для понимания структуры данных Achievement/Badge
4. Определи, как лучше визуализировать badges
5. Продумай отображение критериев получения
6. Только после этого создавай компонент
</thinking>

**Действия:**
- [ ] Создать компонент `components/organisms/pupils/badges-display.tsx`
- [ ] Реализовать отображение списка полученных badges
- [ ] Показать визуальное отображение badges
- [ ] Показать критерии получения (если требуется)
- [ ] Использовать компоненты Shadcn UI для оформления
- [ ] Добавить обработку ошибок

**Документация:**
- <CRITICAL>[MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.5.4 Badges</CRITICAL>
- Phase 15: Система баллов и домиков
- Context7: Shadcn UI компоненты документация

**Критерии приемки:**
- Визуализация badges создана
- Badges отображаются корректно
- Критерии получения понятны
- Компонент следует дизайн-системе
- Обработка ошибок работает

<output_format>
После выполнения задачи должна быть создана визуализация badges, которая отображает список полученных badges с визуальным представлением и критериями получения.
</output_format>

---

### Task 21.06: Реализация графика прогресса

<context>
<CRITICAL>Это критически важная задача для визуализации прогресса!</CRITICAL> График прогресса критически важен для понимания динамики успеваемости ученика. График должен отображать баллы по урокам, тренды успеваемости и прогресс-бары для визуализации прогресса.
</context>

<task>
Установи библиотеку для графиков (recharts) и создай компонент `components/organisms/pupils/progress-chart.tsx` для визуализации прогресса. Реализуй график баллов по урокам, добавь прогресс-бары для визуализации прогресса и отобрази тренды успеваемости. Используй recharts для создания интерактивных графиков.
</task>

<constraints>
- Компонент должен быть Client Component (требуется интерактивность графиков)
- Используй recharts для графиков (установить через `npm install recharts`)
- График должен быть интерактивным и адаптивным
- Данные должны быть получены через amplifyData (передавать из Server Component)
- График должен отображать тренды успеваемости
- Обработка ошибок обязательна
- График должен быть доступным (WCAG 2.1 AA)
</constraints>

<thinking>
Прежде чем приступить к реализации:
1. Изучи MVP_SCOPE.md раздел 2.5.5 График прогресса для понимания требований
2. Используй Context7 для получения актуальной документации recharts
3. Изучи GraphQL схему для понимания структуры данных для графика
4. Определи, какие данные нужны для графика (баллы по урокам, даты)
5. Продумай структуру компонента (Client Component с данными из Server Component)
6. Только после этого устанавливай библиотеку и создавай компонент
</thinking>

**Действия:**
- [ ] Установить библиотеку для графиков: `npm install recharts`
- [ ] Создать компонент `components/organisms/pupils/progress-chart.tsx`
- [ ] Реализовать график баллов по урокам
- [ ] Добавить прогресс-бары для визуализации прогресса
- [ ] Отобразить тренды успеваемости
- [ ] Сделать график интерактивным и адаптивным
- [ ] Добавить обработку ошибок
- [ ] Обеспечить доступность (WCAG 2.1 AA)

**Документация:**
- <CRITICAL>[MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.5.5 График прогресса</CRITICAL>
- <CRITICAL>recharts официальная документация (через Context7)</CRITICAL>
- Context7: React Client Components документация

**Критерии приемки:**
- График прогресса создан
- Данные отображаются корректно
- График интерактивен
- График адаптивен для разных экранов
- График доступен (WCAG 2.1 AA)
- Обработка ошибок работает

<output_format>
После выполнения задачи должен быть создан интерактивный график прогресса, который отображает баллы по урокам, тренды успеваемости и прогресс-бары с использованием recharts.
</output_format>

---

### Task 21.07: Тестирование функционала карточек учеников

<context>
<CRITICAL>Это финальная задача фазы!</CRITICAL> Тестирование функционала карточек учеников критически важно для подтверждения правильности работы всех компонентов. Все функции должны быть протестированы перед переходом к следующей фазе.
</context>

<task>
Протестируй весь функционал карточек учеников: отображение профиля, статистику, историю уроков, визуализацию домиков и badges, график прогресса. Убедись, что все компоненты работают корректно, данные отображаются правильно, и нет критических ошибок.
</task>

<constraints>
- Все функции должны быть протестированы
- Тестирование должно включать проверку на разных экранах (Mobile, Tablet, Desktop)
- Должна быть проверена обработка ошибок
- Должна быть проверена доступность (WCAG 2.1 AA)
- Не должно быть критических ошибок в консоли браузера
- Все данные должны отображаться корректно
</constraints>

<thinking>
Прежде чем приступить к тестированию:
1. Убедись, что все предыдущие задачи выполнены
2. Подготовь тестовые данные для проверки всех функций
3. Определи все сценарии тестирования
4. Проверь работу на разных экранах
5. Проверь обработку ошибок
6. Только после этого проводи тестирование
</thinking>

**Действия:**
- [ ] Протестировать отображение профиля
- [ ] Протестировать статистику
- [ ] Протестировать историю уроков
- [ ] Протестировать визуализацию домиков и badges
- [ ] Протестировать график прогресса
- [ ] Проверить работу на разных экранах (Mobile, Tablet, Desktop)
- [ ] Проверить обработку ошибок
- [ ] Проверить доступность (WCAG 2.1 AA)
- [ ] Проверить отсутствие ошибок в консоли браузера

**Документация:**
- [MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.5 Личные карточки учеников
- [TEACHER_FLOWS.md](../../../user_flows/TEACHER_FLOWS.md) - раздел 5.1

**Критерии приемки:**
- Все тесты пройдены успешно
- Функционал работает корректно
- Нет критических ошибок
- Компоненты адаптивны для разных экранов
- Доступность соответствует WCAG 2.1 AA

<output_format>
После выполнения задачи весь функционал карточек учеников должен быть протестирован, все функции должны работать корректно, и не должно быть критических ошибок.
</output_format>

---

## Ссылки на документацию проекта

- [WIREFRAMES.md](../../../ui_ux/WIREFRAMES.md) - Pupil Profile Pages
- [MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.5
- [TEACHER_FLOWS.md](../../../user_flows/TEACHER_FLOWS.md) - раздел 5.1

---

**Версия:** 1.0  
**Последнее обновление:** 23 декабря 2025
