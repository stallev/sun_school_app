# Phase 24: Управление учебным процессом (Admin)

## Описание фазы
Реализация управления учебным процессом для Admin: глобальное завершение учебного года, создание нового учебного года для выбранных групп, блокировка создания уроков после завершения года.

## Зависимости
Phase 12: Управление учебными годами (Academic Years)

## Оценка времени
3-4 часа

## Требования к AI Agent

> [!IMPORTANT]
> - AI Agent при создании программного кода должен использовать актуальную документацию через Context7
> - Следовать принципам из `docs/guidelines/prompts/general_prompt_guidelines.md`

## Задачи

### Task 24.01: Создание Server Actions для управления учебным процессом
- [ ] Создать `app/actions/academicProcess.ts`
- [ ] Реализовать `completeAllAcademicYears()` - глобальное завершение всех активных годов
- [ ] Реализовать `createNewAcademicYearForGroups(groups, yearData)` - создание нового года для групп
- [ ] Добавить проверку прав доступа (Admin only)

**Документация:**
- [SERVER_ACTIONS.md](../../../api/SERVER_ACTIONS.md) - раздел Academic Process
- [MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.12 Управление учебным процессом

**Критерии приемки:**
- Все Server Actions созданы
- Проверка прав доступа работает

---

### Task 24.02: Создание UI для завершения учебного года
- [ ] Создать `app/(private)/school-process-management/page.tsx`
- [ ] Реализовать форму завершения учебного года
- [ ] Показать список всех активных учебных годов
- [ ] Добавить подтверждение завершения
- [ ] Показать предупреждение о последствиях

**Документация:**
- [MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.12.1 Завершение учебного года
- [USER_FLOW.md](../../../user_flows/USER_FLOW.md) - раздел Admin flows

**Критерии приемки:**
- UI создан
- Подтверждение показывается

---

### Task 24.03: Реализация глобального завершения
- [ ] Реализовать логику завершения всех активных учебных годов
- [ ] Изменить статус всех активных годов на COMPLETED
- [ ] Показать уведомление об успешном завершении
- [ ] Обновить UI после завершения

**Документация:**
- [MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.12.1

**Критерии приемки:**
- Глобальное завершение работает
- Все активные годы завершены

---

### Task 24.04: Реализация создания нового учебного года
- [ ] Создать форму создания нового учебного года
- [ ] Реализовать множественный выбор групп
- [ ] Реализовать поля: название, дата начала, дата окончания
- [ ] Создать учебный год для выбранных групп
- [ ] Установить статус ACTIVE

**Документация:**
- [MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.12.2 Создание нового учебного года

**Критерии приемки:**
- Создание нового года работает
- Год создается для выбранных групп

---

### Task 24.05: Блокировка создания уроков после завершения года
- [ ] Обновить Server Action `createLesson`:
  - Проверять наличие активного года
  - Возвращать ошибку, если активного года нет
- [ ] Обновить UI создания урока:
  - Показывать сообщение о необходимости создания нового года
  - Блокировать форму

**Документация:**
- [MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.12.1 Блокировка создания уроков

**Критерии приемки:**
- Блокировка работает
- Сообщения понятны пользователю

---

### Task 24.06: Тестирование функционала управления процессом
- [ ] Протестировать завершение учебного года
- [ ] Протестировать создание нового года
- [ ] Протестировать блокировку создания уроков

**Критерии приемки:**
- Все тесты пройдены успешно
- Функционал работает корректно

---

## Ссылки на документацию проекта

- [SERVER_ACTIONS.md](../../../api/SERVER_ACTIONS.md) - Academic Process Actions
- [MVP_SCOPE.md](../../../MVP_SCOPE.md) - раздел 2.12

---

**Версия:** 1.0  
**Последнее обновление:** 23 декабря 2025

